@startuml PDF to JPG Converter
title PDF to JPG Conversion Workflow

skinparam backgroundColor white

participant user
participant api
participant worker
participant db
participant s3
participant nats

user->api: POST /pdf-to-jpg
api->db: CREATE job (filename, jobType, jobID, status=PENDING)
api->s3: UPLOAD pdf
api->nats: PRODUCE jobID
api->user: RES jobID
====
user->api: GET /job/{jobID}/status
api->db: GET job status
api->user: RES {status, error?}
====
nats->worker: CONSUME jobID
worker->s3: GET pdf
worker->worker: Convert PDF to JPG
worker->s3: UPLOAD jpg
worker->db: UPDATE job status=COMPLETED
worker->nats: PRODUCE completion_event
====
alt conversion error
    worker->db: UPDATE job status=FAILED, error=message
end
@enduml